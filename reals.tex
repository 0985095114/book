\newcommand{\rclim}{\mathsf{lim}} % HIT constructor for Cauchy reals
\newcommand{\rcrat}{\mathsf{rat}} % Embedding of rationals into Cauchy reals
\newcommand{\rceq}{\mathsf{eq}_{\RC}} % HIT path constructor
\newcommand{\CAP}{\mathcal{C}}    % The type of Cauchy approximations
\newcommand{\Qp}{\Q_{+}}
\newcommand{\apart}{\mathrel{\#}}  % apartness
\newcommand{\dcut}{\mathsf{isCut}}  % Dedekind cut


\chapter{Real Numbers}
\label{cha:real-numbers}

Any foundation of mathematics worthy of its name must eventually address the construction
of real numbers as understood by mathematical analysis, namely as a complete archimedean
ordered field. Completeness can be understood either in the sense of Cauchy or Dedekind.
We shall use the familiar Dedekind's construction for our main development, but we we also
present in \autoref{sec:cauchy-reals} an intriguing construction of
Cauchy reals which uses a form of higher induction-induction.

It is worth pointing out that the total space of the universal cover of the circle, which
in \autoref{subsec:pi1s1-homotopy-theory} played a role similar to ``the real numbers'' in
classical algebraic topology, is \emph{not} the type of reals we are looking for. That
type is contractible, and thus equivalent to the singleton type, so it cannot be equipped
with a non-trivial algebraic structure.


\section{The Field of Rational Numbers}
\label{sec:field-rati-numb}

We first construct the rational numbers \Q, as the reals can then be seen as a completion
of~\Q. An expert will point out that \Q could be replaced by any approximate field, i.e.,
a subring of \Q in which arbitrarily precise approximate inverses exist. An example is the
ring of dyadic rationals, which are those of the form $n/2^k$. From an implementation
point of view an approximate field is more suitable, but we leave such finesse for those
who care about the digits of~$\pi$.

We constructed the integers \Z in \autoref{sec:set-quotients} as a quotient of $\N\times
\N$, and observed that this quotient is generated by an idempotent. In
\autoref{sec:free-algebras} we saw that \Z is the free group on \unit; we could similarly
show that it is the free commutative ring on \emptyt. The field of rationals \Q is
constructed along the same lines as well, namely as the quotient
%
\[ \Q \defeq (\Z \times \N)/{\approx} \]
%
where
\[ (u,a) \approx (v,b) \defeq (u (b + 1) = v (a + 1)). \]
%
In other words, a pair $(u, a)$ represents the rational number $u / (1 + a)$. There can be
no division by zero because we cunningly added one to the denominator~$a$. Here too we
have a canonical choice of representatives, namely fractions in lowest terms. Thus we may
apply \autoref{lem:quotient-when-canonical-representatives} to obtain a set \Q, which
again has a decidable equality.

We do not bother to write down the arithmetical operations on \Q as we trust our readers
know how to compute with fractions even in the case when one is added to the denominator.
Let us just record the conclusion that there is an entirely unproblematic construction of
the ordered field of rational number \Q, with a decidable equality and decidable order.
The field \Q can also be characterized as the initial one.

\section{Dedekind Reals}
\label{sec:dedekind-reals}

Let us first recall the basic idea of Dedekind's construction. We use two-sided Dedekind
cuts, as opposed to an often used one-sided version, because they work classically as well
as constructively. A \emph{Dedekind cut} consists of a pair $(L, U)$ of subsets $L, U
\subseteq \Q$, called the \emph{lower} and \emph{upper cut} respectively, which are:
% 
\begin{enumerate}
\item \emph{inhabited}: there are $q \in L$ and $r \in U$,
\item \emph{rounded:} $q \in L \Leftrightarrow \exists r \in Q .\; q < r \in L$
  and $r \in U \Leftrightarrow \exists r \in Q .\; U \ni q < r$,
\item \emph{disjoint:} $\lnot (q \in L \land q \in U)$, and
\item \emph{located:} $q < r \Rightarrow q \in L \lor r \in U$.
\end{enumerate}
%
Reading the roundedness condition from left to right tells us that cuts are \emph{open},
and from right to left that they are \emph{lower}, respectively \emph{upper}, sets. The
locatedness condition states that there is no large gap between $L$ and $U$. Because cuts
are always open, they never include the ``point in between'', even when it is rational. A
typical Dedekind cut looks like this:
%
\begin{center}
  \begin{tikzpicture}
    \draw[<-),line width=1.5pt] (0,0) -- (3.99,0) node[anchor=south east]{$L\ $};
    \draw[(->,line width=1.5pt] (4.01, 0) node[anchor=south west]{$\ U$} -- (14, 0) ;
  \end{tikzpicture}
\end{center}
%
We might naively translate the informal definition into type theory by saying that a cut
is a pair of maps $L, U : \Q \to \prop$. But we saw in \autoref{subsec:prop-subsets} that
$\prop$ is an ambiguous notation for $\prop_{\UU_i}$ where~$\UU_i$ is a universe. Once we
use a particular $\UU_i$ to define cuts, the type of reals will reside in the next
universe $\UU_{i+1}$, a property of reals two levels higher in $\UU_{i+2}$, a property of
subsets of reals in $\UU_{i+3}$, etc. In principle we should be able to keep track of the
universe levels, especially with the help of a proof assistant, but doing so here would
just burden us with bureaucracy that we prefer to avoid. We shall therefore make a
simplifying assumption that a single type of propositions $\Omega$ is sufficient for all
our purposes.

In fact, the construction of the Dedekind reals is quite resilient to logical
manipulations. There are several ways in which we can make sense of using a single type
$\Omega$:
%
\begin{enumerate}

\item We could identify $\Omega$ with the ambiguous $\prop$ and track all the universes
  that appear in definitions.

\item We could assume impredicativity of mere propositions, cf.\
  \ref{subsec:prop-subsets}, which essentially collapses the $\prop_{\UU_i}$'s to the
  lowest level, which we call $\Omega$.

\item A classical mathematician who is not interested in the intricacies of type-theoretic
  universes or computation may simply assume the law of excluded middle~\eqref{eq:lem} for
  mere propositions so that $\Omega \jdeq \bool$. This not only eradicates questions about
  levels of $\prop$, but also turns everything we do into the standard classical
  construction of real numbers. We discuss this point further in
  \autoref{sec:intuitionistic-vs-classical-analysis}.

\item On the other end of the spectrum one might ask for a minimal requirement that makes
  the constructions work. The condition that a mere predicate be a Dedekind cuts is
  expressible using only conjunctions, disjunctions existential quantifiers over~\Q, which
  is a countable set. Thus we could take $\Omega$ to be the initial \emph{$\sigma$-frame},
  i.e., a lattice with countable joins in which binary meets distribute over countable
  joins. (The initial $\sigma$-frame cannot be the two-point lattice $\bool$ because
  $\bool$ is not closed under countable joins, unless we assume excluded middle.) This
  would lead to a construction of~$\Omega$ as a higher inductive-inductive type, but one
  experiment of this kind in \autoref{sec:cauchy-reals} is enough.
\end{enumerate}

In all of the above cases $\Omega$ is a set.
%
Without further ado, we translate the informal definition into type theory. We use the
logical notation from \autoref{defn:logical-notation}.

\begin{defn}
  A \emph{Dedekind cut} is a pair $(L, U)$ of mere propositions $L : \Q \to \Omega$ and $U
  : \Q \to \Omega$ which is:
  %
  \begin{enumerate}
  \item \emph{inhabited}: $\exis{q : \Q} L(q)$ and $\exis{r : Q} U(r)$,
  \item \emph{rounded:} for all $q, r : \Q$,
    %
    \begin{equation*}
      L(q) \Leftrightarrow \exis{r : \Q} (q < r) \land L(r)
      \quad\text{and}\quad
      U(r) \Leftrightarrow \exis{r : \Q} (q < r) \land L(r),
    \end{equation*}
  \item \emph{disjoint:} $\lnot (L(q) \land U(q))$ for for all $q : \Q$,
  \item \emph{located:} $(q < r) \Rightarrow L(q) \lor U(r)$ for all $q, r : \Q$.
  \end{enumerate}
  %
  We let $\dcut(L, U)$ denote the conjunction of these conditions. The type of
  \emph{Dedekind reals} is
  %
  \begin{equation*}
    \RD \defeq \setof{ (L, U) : (\Q \to \Omega) \times (\Q \to \Omega) | \dcut(L,U)}.
  \end{equation*}
\end{defn}

It is apparent that $\dcut(L, U)$ is a mere proposition, and since $\Q \to \Omega$ is a set
the Dedekind reals form a set too. 

There is an embedding $\Q \to \RD$ which associates with each rational $q : \Q$ the cut
$(L_q, U_q)$ where
%
\begin{equation*}
  L_q(r) \defeq (r < q)
  \qquad\text{and}\qquad
  U_q(r) \defeq (q < r).
\end{equation*}
%
We shall simply write $q$ for the cut $(L_q, U_q)$ associated with a real number.

The construction of the algebraic and order-theoretic structure of Dedekind reals proceeds
as usual in intuitionistic logic. Rather than dwelling on details we point out the
differences between the classical and intuitionistic setup. Writing $L_x$ and $U_x$ for
the lower and upper cut of a real number $x : \RD$, we define addition as%
%
\begin{align*}
  L_{x + y}(q) &\defeq \exis{r, s : \Q} L_x(r) \land L_y(s) \land q = r + s, \\
  U_{x + y}(q) &\defeq \exis{r, s : \Q} U_x(r) \land U_y(s) \land q = r + s
\end{align*}
%
and the additive inverse by
%
\begin{align*}
  L_{-x}(q) &\defeq \exis{r : \Q} U_x(r) \land q = - r, \\
  U_{-x}(q) &\defeq \exis{r : \Q} L_x(r) \land q = - r.
\end{align*}
%
With these operations $(\RD, 0, {+}, {-})$ is a commutative group. Multiplication is a bit
more cumbersome:
%
\begin{align*}
  L_{x \cdot y}(q) &\defeq
  \begin{aligned}[t]
    \exis{a, b, c, d : \Q} & L_x(a) \land U_x(b) \land L_y(c) \land U_y(d) \land {}\\
                           & \qquad q < \min (a \cdot c, a \cdot d, b \cdot c, b \cdot d),
  \end{aligned} \\
  U_{x \cdot y}(q) &\defeq
  \begin{aligned}[t]
    \exis{a, b, c, d : \Q} & L_x(a) \land U_x(b) \land L_y(c) \land U_y(d) \land {}\\
                           & \qquad \max (a \cdot c, a \cdot d, b \cdot c, b \cdot d) < q.
  \end{aligned}
\end{align*}
%
We now have a commutative ring with unit $(\RD, 0, 1, {+}, {-}, {\cdot})$. To treat
multiplicative inverses, we must first introduce order. Define $\leq$ and $<$ as
%
\begin{align*}
  (x \leq y) &\ \defeq \ \fall{q : \Q} L_x(q) \Rightarrow L_y(q), \\
  (x < y)    &\ \defeq \ \exis{q : \Q} U_x(q) \land L_y(q).
\end{align*}

\begin{lem} \label{dedekind-in-cut-as-le}
  For all $x : \RD$ and $q, r : \Q$, $L_x(q) \Leftrightarrow (q < x)$ and $U_x(r)
  \Leftrightarrow (x < r)$.
\end{lem}

\begin{proof}
  If $L_x(q)$ then by roundedness there merely is $r > q$ such that $L_x(r)$, and since
  $U_q(r)$ it follows that $q < x$. Conversely, if $q < x$ then there is $r : \Q$ such
  that $U_q(r)$ and $L_x(r)$, hence $L_x(q)$ because $L_x$ is a lower set. The other half
  of the proof is symmetric.
\end{proof}

The relation $\leq$ is a partial order, and $<$ is transitive and irreflexive. The
trichotomy law
%
\begin{equation*}
  (x < y) \lor (x = y) \lor (y < x)
\end{equation*}
%
is valid if we assume excluded middle, but without it we get the intuitionistic version
%
\begin{equation} \label{eq:RD-linear-order}
  (x < y) \Rightarrow (x < z) \lor (z < y).
\end{equation}
%
To see this, suppose $x < y$. Then there merely exists $q : \Q$ such that $U_x(q)$ and
$L_y(q)$. By roundedness there merely exist $r, s : \Q$ such that $r < q < s$, $U_x(r)$
and $L_y(s)$. Then, by locatedness $L_z(r)$ or $U_z(s)$. In the first case we get $x < z$
and in the second $z < y$. At first sight it might not be clear
what~\eqref{eq:RD-linear-order} has to do with the linear order. But if we take $x \jdeq
u - \epsilon$ and $y \jdeq u + \epsilon$ for $\epsilon > 0$, then we get
%
\begin{equation*}
  (u - \epsilon < z) \lor (z < u + \epsilon).
\end{equation*}
%
This is linear order ``up to a small numerical error'', i.e., since it is unreasonable to
expect that we can actually compute with infinite precision, we should not be surprised
that we can decide~$<$ only up to whatever finite precision we have computed.

Classically multiplicative inverses exist for all numbers which are different from zero.
However, without excluded middle, a stronger condition is required. Say that $x, y : \RD$
are \emph{apart} from each other, written $x \apart y$, when $(x < y) \lor (y < x)$:
%
\begin{equation*}
  (x \apart y) \defeq (x < y) \lor (y < x).
\end{equation*}
%
If $x \apart y$ then $\lnot (x = y)$, but the converse implies a little bit of excluded
middle known, see \autoref{ex:reals-apart-neq-MP}.

\begin{thm} \label{RD-inverse-apart-0}
  A real is invertible if, and only if, it is apart from $0$.
\end{thm}

\begin{proof}
  Suppose $x \cdot y = 1$. Then there merely exist $a, b, c, d : \Q$ such that
  $a < x < b$, $c < y < d$ and $0 < \min (a c, a d, b c, b d)$. From $0 < a c$ it follows
  that $0 < a < x < c$ or $a < x < c < 0$, hence $x \apart 0$.

  Conversely, if $x \apart 0$ then
  %
  \begin{align*}
    L_{x^{-1}}(q) &\defeq
    \exis{r : \Q} U_x(r) \land ((0 < r \land q r < 1) \lor (r < 0 \land 1 < q r))
    \\
    U_{x^{-1}}(q) &\defeq
    \exis{r : \Q} L_x(r) \land ((0 < r \land q r > 1) \lor (r < 0 \land 1 > q r))
  \end{align*}
  %
  defines the desired inverse. Indeed, $L_{x^{-1}}$ and $U_{x^{-1}}$ are bounded because
  $x \apart 0$.
\end{proof}

The archimedean axiom can be stated in several ways. We find it most illuminating in the
form which says that $\Q$ is dense in $\RD$. Let $\Qp = \setof{ q : \Q | q > 0 }$ be the
type of positive rational numbers.

\begin{lem} \label{RD-multi-located}
  Suppose $x : \RD$ and $q_0 < \cdots < q_{n+1}$ are rational numbers such that $q_0 < x <
  q_{n+1}$. Then there merely exist $i, j$ such that $q_i < x < q_j$ and $j - i \leq 2$.
\end{lem}

\begin{proof}
  We proceed by induction on~$n$. If $n = 0$ or $n = 1$ then we may take $i = 0$ and $j =
  n + 1$. For the induction step, consider $q_0 < \cdots < q_{n+3}$ such that $q_0 < x <
  q_{n+3}$. Because $x$ is located and $q_1 < q_{n+2}$, merely $q_1 < x$ or $x < q_{n+2}$.
  In the first case we apply the induction hypothesis to $q_1 < \cdots < q_{n+3}$ and in
  the second to $q_0 < \cdots < q_{n+2}$.
\end{proof}

\begin{thm}[Archimedean axiom] \label{RD-archimedean}
  %
  For every $x : \RD$ and $\epsilon : \Qp$ there merely exist $q, r : \Q$ such that $q < x
  < r$ and $r - q < \epsilon$.
\end{thm}

\begin{proof}
  Because $x$ is bounded there merely exist $s, t : \Q$ such that $s < x < t$. There
  exists $n : \N$ such that $2 (t - s)/(n + 1) < \epsilon$. We apply
  \autoref{RD-multi-located} to the sequence
  %
  \begin{equation*}
    q_k \defeq \frac{n + 1 - k}{n+1} \cdot s + \frac{k}{n+1} \cdot t
  \end{equation*}
  where $k = 0, \ldots, n+1$ to obtain $i, j$ such that $q_i < x < q_j$ and $j - i \leq
  2$. Because $q_j - q_i = (j - i) (t - s)/(n + 1) < \epsilon$ we may take $q \defeq q_i$
  and $r \defeq q_j$.
\end{proof}

There are two notions of completeness of real numbers, and the Dedekind reals enjoy both.


\subsection{Dedekind reals are Cauchy complete}
\label{sec:RD-cauchy-complete}

Recall that $x : \N \to \Q$ is a \emph{Cauchy sequence} when it satisfies
%
\begin{equation} \label{eq:cauchy-sequence}
  \prd{\epsilon : \Qp} \sm{n : \N} \prd{m, k \geq n} |x_m - x_k| < \epsilon.
\end{equation}
%
Note that we did \emph{not} truncate the inner existential because we actually want to
compute rates of convergence---an approximation without an error estimate carries little
useful information. By \autoref{thm:ttac}, \eqref{eq:cauchy-sequence} yields
a function $M : \Qp \to \N$, called the \emph{modulus of convergence}, such that
$|x_{M(\delta)} - x_{M(\epsilon)}|< \delta + \epsilon$. In fact, the composition $x \circ
M : \Qp \to \Q$ carries the same information about the limit as the original Cauchy
condition~\eqref{eq:cauchy-sequence}. We shall work with these approximation functions
rather than with Cauchy sequences.

\begin{defn}\label{defn:cauchy-approximation}
  A \textbf{Cauchy approximation} is a map $x : \Qp \to \RD$ which satisfies
  %
  \begin{equation}
    \label{eq:cauchy-approx}
    \fall{\delta, \epsilon :\Qp} |x_\delta - x_\epsilon| \leq \delta + \epsilon.
  \end{equation}
  %
  The \emph{limit} of a Cauchy approximation $x : \Qp \to \RD$ is a number $\ell : \RD$ such
  that
  % 
  \begin{equation*}
    \fall{\epsilon : \Qp} |x_\epsilon - \ell| \leq \epsilon.
  \end{equation*}
\end{defn}

\begin{thm} \label{RD-cauchy-complete}
  Every Cauchy approximation in $\RD$ has a limit.
\end{thm}

\begin{proof}
  Given a Cauchy approximation $x : \Qp \to \RD$, define
  % 
  \begin{align*}
    L_y(q) &\defeq \exis{\epsilon, \theta : \Qp} q + \epsilon + \theta < x_\epsilon,\\
    U_y(q) &\defeq \exis{\epsilon, \theta : \Qp} q - \epsilon - \theta > x_\epsilon.
  \end{align*}
  %
  It is clear that $L_y$ and $U_y$ are bounded, rounded, and disjoint. To establish
  locatedness, consider any $q, r : \Q$ such that $q < r$. There is $\epsilon : \Qp$ such
  that $5 \epsilon < r - q$. Since $q + 2 \epsilon < r - 2 \epsilon$ merely $q + 2
  \epsilon < x_\epsilon$ or $x_\epsilon < r - 2 \epsilon$.

\end{proof}


\subsection{Dedekind reals are Dedekind complete}
\label{sec:RD-dedekind-complete}



\begin{thm} \label{RD-dedekind-complete} The Dedekind reals are Dedekind complete: if $L :
  \RD \to \Omega$ and $U : \RD \to \Omega$ form a \emph{real-valued} Dedekind cut, then
  there is a unique $x : \RD$ such that $L(y) = (y < x)$ and $U(y) = (x < y)$ for all $y :
  \RD$.
\end{thm}

\begin{proof}
  A real-valued cut $(L, U)$ is just like an ordinary cut, with rational numbers replaced
  by real numbers troughout. For example, the roundedness condition for~$L$ states that
  $L(x) = \exis{y : \RD} (x < y) \land L(y)$.

  Let $i : \Q \to \RD$ be the inclusion of rational numbers into the Dedekind reals.
  Define $L_x, U_x : \Q \to \Omega$ by $L_x \defeq L \circ i$ and $U_x \defeq U \circ i$.
  It is not hard to check that $x \defeq (L_x, U_x)$ is a cut, so we verify that $L(y) =
  (y < x)$ for every $y : \RD$.
\end{proof}

\section{Cauchy Reals}
\label{sec:cauchy-reals}

The Cauchy reals are, by intent, the completion of \Q under limits of Cauchy sequences.
In the classical construction of the Cauchy reals, we consider the set of all Cauchy sequences in \Q and then form a suitable quotient.
This construction works well in the presence of the Axiom of Countable Choice (the instance of \autoref{eq:ac} where $X=\N$).
However, in the absence of Countable Choice, the classical construction is poorly behaved, as we now explain.

At this point we hit a snag. It would be natural to define the Cauchy reals as the
quotient of the type of Cauchy approximations $\mathcal{C}$ by the coincidence
relation~$\approx$. However, we cannot establish Cauchy completeness of $\mathcal{C}/{\approx}$,
because it takes Countable Choice to lift a sequence of reals $x : \N \to
\mathcal{C}/{\approx}$ to a sequence of Cauchy approximations $\N \to \mathcal{C}$.
Without such a lifting, we cannot construct a Cauchy approximation for the limit of the sequences.

Every construction of reals whose last step is a quotient suffers from this deficiency.
There are three common ways out of the conundrum in constructive mathematics:
%
\begin{enumerate}
\item Pretend that the reals are a setoid $(\mathcal{C}, {\approx})$, i.e., the type of
  Cauchy approximations $\mathcal{C}$ with a coincidence relation attached to it by
  administrative decree. A sequence of reals them simply \emph{is} a sequence of Cauchy
  approximations representing them.
\item Give in to temptation and accept the Axiom of Countable Choice. After all, the axiom
  is valid in most models of constructive mathematics based on a computational viewpoint,
  such as realizability models.
\item Declare the Cauchy reals unworthy and construct the Dedekind reals instead.
  Such a verdict is perfectly valid in certain contexts, such as in sheaf-theoretic models of constructive mathematics.
  However, as we saw in \autoref{sec:dedekind-reals}, the constructive Dedekind reals have their own problems.
\end{enumerate}

Using higher inductive types, however, there is a fourth solution, which we believe to be preferable to any of the above, and interesting even to a classical mathematician.
The idea is that the Cauchy real numbers should be the \emph{free complete metric space} generated by \Q.
In general, the construction of a free gadget of any sort requires applying the gadget operations repeatedly many times to the generators.
For instance, the elements of the free group on a set $X$ are not just binary products and inverses of elements of $X$, but words obtained by iterating the product and inverse constructions.
Thus, we might naturally expect the same to be true for Cauchy completion, with the relevant ``operation'' being ``take the limit of a Cauchy sequence''.
(In this case, the iteration would have to take place transfinitely, since even after infinitely many steps there will be new Cauchy sequences to take the limit of.)

The argument referred to above shows that if Countable Choice holds, then Cauchy completion is very special: when building the completion of a space, it suffices to stop applying the operation after \emph{one step}.
This may be regarded as analogous to the fact that free monoids and free groups can be given explicit descriptions in terms of (quotients of) words.
However, we saw in \autoref{sec:free-algebras} that higher inductive types allow us to construct free gadgets \emph{directly}, whether or not there is also an explicit description available.
In this section we show that the same is true for the Cauchy reals (a similar technique would construct the Cauchy completion of any metric space).
Specifically, higher inductive types allow us to \emph{simultaneously} add limits of Cauchy sequences and quotient by the coincidence relation, so that we can avoid the problem of lifting a sequence of reals to a sequence of representatives.


\subsection{Construction of Cauchy Reals}
\label{sec:constr-cauchy-reals}

The construction of the Cauchy reals $\RC$ as a higher inductive type is a bit more subtle than that of the free algebraic structures considered in \autoref{sec:free-algebras}.
We intend to include a ``take the limit'' constructor whose input is a Cauchy sequence of reals, but the notion of ``Cauchy sequence of reals'' depends on having some way to measure the ``distance'' between real numbers.
In general, of course, the distance between two real numbers will be another real number, leading to a potentially problematic circularity.

However, what we actually need for the notion of Cauchy sequence (or Cauchy approximation) of reals is not the general notion of ``distance'', but a way to say that ``the distance between two real numbers is less than $\epsilon$'' for any $\epsilon:\Qp$.
This can be represented by a family of binary relations, which we will denote $\mathord{\sim_\epsilon} : \RC\to\RC\to \prop$.
The intended meaning of $x \sim_\epsilon y$ is $|x - y| < \epsilon$, but since we do not have notions of subtraction, absolute value, or inequality available yet (we are only just defining $\RC$, after all), we will have to define these relations $\sim_\epsilon$ at the same time as we define $\RC$ itself.
And since $\sim_\epsilon$ is a type family indexed by two copies of $\RC$, we cannot do this with an ordinary mutual (higher) inductive definition; instead we have to use a \emph{higher inductive-inductive definition}.

Recall from \autoref{sec:generalizations} that the ordinary notion of inductive-inductive definition allows us to define a type and a type family indexed by it by simultaneous induction.
Of course, the ``higher'' version of this allows both the type and the family to have path-constructors as well as point-constructors.
We will not attempt to formulate any general theory of higher inductive-inductive definitions, but hopefully the description we will give of $\RC$ and $\sim_\epsilon$ will make the idea transparent.

\begin{rmk}
  We might also consider a \emph{higher inductive-recursive definition}, in which $\sim_\epsilon$ is defined using the \emph{recursion} principle of $\RC$, simultaneously with the \emph{inductive} definition of $\RC$.
  We choose the inductive-inductive route instead for two reasons.
  Firstly, higher inductive-recursive definitions seem to be more difficult to justify in homotopical semantics.
  Secondly, and more importantly, the inductive-inductive definition yields a more powerful induction principle, which we will need in order to develop even the basic theory of Cauchy reals.
\end{rmk}

\begin{defn}\label{defn:cauchy-reals}
  Let $\RC$ and the relation $\sim:\Qp \times \RC \times \RC \to \type$ be the following higher inductive-inductive type family.
  The type $\RC$ of \textbf{Cauchy reals} is generated by the following constructors:
  \begin{itemize}
  \item \emph{rational points:} 
    for any $q : \Q$ there is a real $\rcrat(q)$.
  \item \emph{limit points}:
    for any $x : \Qp \to \RC$ such that
    %
    \begin{equation}
      \label{eq:RC-cauchy}
      \fall{\delta, \epsilon : \Qp} x_\delta \sim_{\delta + \epsilon} x_\epsilon
    \end{equation}
    %
    there is a point $\rclim(x) : \RC$. We call $x$ a \emph{Cauchy approximation}.
    %
  \item \emph{paths:}
    for $u, v : \RC$ such that
    %
    \begin{equation}
      \label{eq:RC-path}
      \fall{\epsilon : \Qp} u \sim_\epsilon v
    \end{equation}
    %
    then there is a path $\rceq(u, v) : \id[\RC]{u}{v}$.
  \end{itemize}
  Simultaneously, the type family $\mathord\sim:\RC\to\RC\to\Qp \to\type$ is generated by the following constructors:
  \begin{itemize}
  \item For $q,r,\epsilon:\Qp$, if $-\epsilon < q - r < \epsilon$, then $\rcrat(q) \sim_\epsilon \rcrat(r)$.
  \item For $q:\Q$ and $\delta,\epsilon,\theta:\Qp$ and $y$ a Cauchy approximation, if $\rcrat(q) \sim_{\epsilon - \delta - \theta} y_\delta$, then $\rcrat(q) \sim_{\epsilon} \rclim(y)$.
  \item For $r:\Q$ and $\delta,\epsilon,\theta:\Qp$ and $x$ a Cauchy approximation, if $x_\delta \sim_{\epsilon - \delta - \theta} \rcrat(r)$, then $\rclim(x) \sim_\epsilon \rcrat(r)$.
  \item For $\epsilon,\delta,\eta,\theta:\Qp$ and $x,y$ Cauchy approximations, if $x_\delta \sim_{\epsilon - \delta - \eta - \theta} y_\eta$, then $\rclim(x) \sim_\epsilon \rclim(y)$.
  \item The propositional truncation constructor: for $\epsilon:\Qp$ and $x,y:\RC$, and $\xi,\zeta:x\sim_{\epsilon} y$, we have $\xi=\zeta$.
  \end{itemize}
\end{defn}

The first constructor of $\RC$ says that any rational number can be regarded as a real number.
The second says that from any Cauchy approximation to a real number, we can obtain a new real number called its ``limit''.
And the third expresses the idea that if two Cauchy approximations coincide, then their limits are equal.
(Note that the notion of ``coincidence'' is \emph{simpler} than that of \autoref{defn:cauchy-approximation}, since we are free to use the relation $\sim$ between Cauchy reals themselves.
Moreover, it also handles equalites between limits and rational points.)

The first four constructors of $\sim$ specify when two rational numbers are close, when a rational is close to a limit, and when two limits are close.
In the case of two rational numbers, this is just the usual notion of $\epsilon$-closeness for rational numbers, whereas the other cases can be derived by noting that each approximant $x_\delta$ is supposed to be within $\delta$ of the limit $\rclim(x)$.
The mysterious $\theta$s are there to give extra ``wiggle room'', ensuring that $\sim$ behaves like $<$ and not like $\leq$.

We remind ourselves of proof-relevance: a real number obtained from $\rclim$ is represented not
just by a Cauchy approximation $x$, but also a proof $p$ of~\eqref{eq:RC-cauchy}, so we
should technically have written $\rclim(x,p)$ instead of just $\rclim(x)$.
A similar observation also applies to $\rceq$ and~\eqref{eq:RC-path}, but we shall write just
$\rceq : u = v$ instead of $\rceq(u, v, p) : u = v$. These abuses of notation are
mitigated by the fact that we are omitting mere propositions and information that is
readily guessed.
Likewise, the last constructor of $\mathord{\sim_\epsilon}$ justifies our leaving the other four nameless.

We are immediately able to populate $\RC$ with many real numbers. For suppose $q : \N \to
\Q$ is a traditional Cauchy sequence of rational numbers, and let $M : \Qp \to \N$ be its
modulus of convergence. Then $\rcrat \circ q \circ M : \Qp \to \RC$ is a Cauchy
approximation, using the first constructor of $\sim$ to produce the necessary witness.
Thus, $\rclim(\rcrat \circ q \circ m)$ is a real number. Various famous
real numbers $\sqrt{2}$, $\pi$, $e$, \dots are are all limits of such Cauchy sequences of
rationals.

\medskip

In order to do anything useful with $\RC$, of course, we need to give its induction principle.
As is the case whenever we inductively define two or more objects at once, the basic induction principle for $\RC$ and $\mathord\sim$ requires a simultaneous induction over both at once.
Thus, we should expect it to say that assuming two type families over $\RC$ and $\sim$, respectively, together with data corresponding to each constructor, there exist sections of both of these families.
However, since $\sim$ is indexed on on two copies of $\RC$, the precise dependencies of these families is a bit subtle.
The induction principle will apply to any pair of type families:
\begin{align*}
A&:\RC\to\type\\
B&:\prd{x,y:\RC}{a:A(x)}{b:A(y)}{\epsilon:\Qp} (x\sim_\epsilon y) \to \type.
\end{align*}
The type of $A$ is obvious, but the type of $B$ requires a little thought.
Since $B$ must depend on $\sim$, but $\sim$ in turn depends on two copies of $\RC$ and one copy of $\Qp$, it is fairly obvious that $B$ must also depend on the variables $x,y:\RC$ and $\epsilon:\Qp$ as well as an element of $(x\sim_\epsilon y)$.
What is slightly less obvious is that $B$ must also depend on two variables $a:A(x)$ and $b:A(y)$ of type $A$.

This may be more evident if we consider the non-dependent case (the recursion principle), where $A$ is a simple type.
In this case we would expect $B$ not to depend on $x,y:\RC$ or $x\sim_\epsilon y$.
But the recursion principle (along with its associated uniqueness principle) is supposed to say that $\RC$ with $\sim_\epsilon$ is an ``initial object'' in some category, so in this case the dependency structure of $A$ and $B$ should mirror that of $\RC$ and $\sim_\epsilon$: that is, we should have $B:A\to A\to \Qp \to \type$.
Combining this observation with the fact that, in the dependent case, $B$ must also depend on $x,y:\RC$ and $x\sim_\epsilon y$, leads inevitably to the type given above for $B$.

Now, given $A$ and $B$ as above, the hypotheses of the induction principle consist of the following data, one for each constructor of $\RC$ or $\sim$.
\begin{itemize}
\item For any $q : \Q$, an element $f_q:A(\rcrat(q))$.
\item For any Cauchy approximation $x$, and any $a:\prd{\epsilon:\Qp} A(x_\epsilon)$ such that
  \begin{equation}
    \fall{\delta, \epsilon : \Qp} B(x_\delta,x_\epsilon,a_\delta,a_\epsilon,\delta+\epsilon,\blank),\label{eq:depCauchyappx}
  \end{equation}
  an element $f_{x,a}:A(\rclim(x))$.  We call such $a$ a \emph{dependent Cauchy approximation} over $x$.
\item For $u, v : \RC$ and $h:\fall{\epsilon : \Qp} u \sim_\epsilon v$, and $a:A(u)$ and $b:A(v)$ such that $\fall{\epsilon:\Qp} B(u,v,a,b,\epsilon,h(\epsilon))$, a dependent path $\dpath{A}{\rceq(u,v)}{a}{b}$.
\item For $q,r:\Q$ and $\epsilon:\Qp$, if $-\epsilon < q - r < \epsilon$, an element of $B(\rcrat(q),\rcrat(r),f_q,f_r,\epsilon,\blank)$.
\item For $q:\Q$ and $\delta,\epsilon,\theta:\Qp$ and $y$ a Cauchy approximation, and $b$ a dependent Cauchy approximation over $y$, if $\rcrat(q) \sim_{\epsilon - \delta - \theta} y_\delta$, then
  \[B(\rcrat(q),y_\delta,f_q,b_\delta,\epsilon-\delta-\theta,\blank)
  \to
  B(\rcrat(q),\rclim(y),f_q,f_{y,b},\epsilon,\blank).\]
\item Similarly, for $r:\Q$ and $\delta,\epsilon,\theta:\Qp$ and $x$ a Cauchy approximation, and $a$ a dependent Cauchy approximation over $x$, if $x_\delta \sim_{\epsilon - \delta - \theta} \rcrat(r)$, then
  \[B(x_\delta,\rcrat(r),a_\delta,f_r,\epsilon-\delta-\theta,\blank) \to
  B(\rclim(y),\rcrat(q),f_{x,a},r,\epsilon,\blank).
  \]
\item For $\epsilon,\delta,\eta,\theta:\Qp$ and $x,y$ Cauchy approximations, and $a$ and $b$ dependent Cauchy approximations over $x$ and $y$ respectively, if $x_\delta \sim_{\epsilon - \delta - \eta - \theta} y_\eta$, then
  \[ B(x_\delta,y_\eta,a_\delta,b_\eta,{\epsilon - \delta - \eta - \theta},\blank)\to
  B(\rclim(x),\rclim(y),f_{x,a},f_{y,b},\epsilon,\blank).\]
\item For $\epsilon:\Qp$ and $x,y:\RC$ and $\xi,\zeta:x\sim_{\epsilon} y$, and $a:A(x)$ and $b:A(y)$, any two elements of $B(x,y,a,b,\epsilon,\xi)$ and $B(x,y,a,b,\epsilon,\zeta)$ are dependently equal over $\xi=\zeta$.
  Note that as usual, this is essentially equivalent to asking that $B$ is a mere relation.
\end{itemize}
Under these hypotheses, we deduce functions
\begin{align*}
  f&:\prd{x:\RC} A(x)\\
  g&:\prd{x,y:\RC}{\epsilon:\Qp}{\xi:x\sim_{\epsilon} y} B(x,y,f(x),f(y),\epsilon,\xi)
\end{align*}
which compute as expected:
\begin{align*}
  f(\rcrat(q)) &\defeq f_q\\
  f(\rclim(x)) &\defeq f_{x,(f,g)[x]}
\end{align*}
Here $(f,g)[x]$ denotes the result of applying $f$ and $g$ to a Cauchy approximation $x$ to obtain a dependent Cauchy approximation over $x$.
That is, we define $(f,g)[x]_\epsilon \defeq f(x_\epsilon) : A(x_\epsilon)$, and then for any $\epsilon,\delta:\Qp$ we have $g(x_\epsilon,x_\delta,\epsilon+\delta,\blank)$ to witness the fact that $(f,g)[x]$ is a dependent Cauchy approximation.

This induction principle is admittedly quite a mouthful.
To help make sense of it, we observe that it contains as special cases two separate induction principles for $\RC$ and for $\sim$.
Firstly, suppose given only a type family $A:\RC\to\type$, and define $B$ to be constant at \unit.
Then much of the required data becomes trivial, and we are left with:
\begin{itemize}
\item For any $q : \Q$, an element $f_q:A(\rcrat(q))$.
\item For any Cauchy approximation $x$, and any $a:\prd{\epsilon:\Qp} A(x_\epsilon)$, an element $f_{x,a}:A(\rclim(x))$.
\item For $u, v : \RC$ and $h:\fall{\epsilon : \Qp} u \sim_\epsilon v$, and $a:A(u)$ and $b:A(v)$, a dependent path $\dpath{A}{\rceq(u,v)}{a}{b}$.
\end{itemize}
Given these data, the induction principle yield a function $f:\prd{x:\RC} A(x)$ such that
\begin{align*}
  f(\rcrat(q)) &\defeq f_q\\
  f(\rclim(x)) &\defeq f_{x,f(x)}.
\end{align*}
We call this principle \emph{$\RC$-induction}; it says essentially that if we take $\sim_\epsilon$ as given, then $\RC$ is inductively generated by its constructors.

In particular, if $A$ is a mere property, the third hypothesis in $\RC$-induction is trivial.
Thus, we may prove mere properties of real numbers by simply proving them for rationals and for limits of Cauchy approximations.
Here is an example.

\begin{lem}
  For any $u:\RC$ and $\epsilon:\Qp$, we have $u\sim_\epsilon u$.
\end{lem}
\begin{proof}
  Define $A(u) \defeq \fall{\epsilon:\Qp} (u\sim_\epsilon u)$.
  Since this is a mere proposition (by the last constructor of $\sim$), by $\RC$-induction, it suffices to prove it when $u$ is $\rcrat(q)$ and when $u$ is $\rclim(x)$.
  In the first case, we obviously have $|q-q|<\epsilon$ for any $\epsilon$, hence $\rcrat(q) \sim_\epsilon \rcrat(q)$ by the first constructor of $\sim$.
  %
  And in the second case, we may assume inductively that $x_\delta \sim_\epsilon x_\delta$ for all $\delta,\epsilon:\Qp$.
  Then in particular, we have $x_{\epsilon/4} \sim_{\epsilon/4} x_{\epsilon/4}$, whence $\rclim(x) \sim_{\epsilon} \rclim(x)$ by the fourth constructor of $\sim$.
\end{proof}

\begin{thm}\label{thm:Cauchy-reals-are-a-set}
  $\RC$ is a set.
\end{thm}
\begin{proof}
  We have just shown that the mere relation $P(u,v) \defeq \fall{\epsilon:\Qp} (u\sim_\epsilon u)$ is reflexive.
  Since it implies identity, by the path-constructor of $\RC$, the result follows from \autoref{thm:h-set-refrel-in-paths-sets}.
\end{proof}

We can also show that although $\RC$ may not be a quotient of the set of Cauchy sequences of \emph{rationals}, it is nevertheless a quotient of the set of Cauchy sequences of \emph{reals}.
(Of course, this is not a valid \emph{definition} of $\RC$, but it is a useful property.)
We define the type of Cauchy approximations to be
% 
\begin{equation*}
  \CAP \defeq
  \setof{ x : \Qp \to \RC |
    \fall{\epsilon, \delta : \Qp} x_\delta \sim_{\delta + \epsilon} x_\epsilon
  }.
\end{equation*}
The second constructor of $\RC$ gives a function $\rclim:\CAP\to\RC$.

\begin{lem} \label{RC-lim-onto}
  Every real merely is a limit point: $\fall{u : \RC} \exis{x : \CAP} u = \rclim(x)$.
  In other words, $\rclim:\CAP\to\RC$ is surjective.
\end{lem}
\begin{proof}
  By $\RC$-induction, we may divide into cases on $u$.
  Of course, if $u$ is a limit $\rclim(x)$, the statement is trivial.
  So suppose $u$ is a rational point $\rcrat(q)$; we claim $u$ is equal to $\rclim(\lam{\blank} \rcrat(q))$.
  By the path-constructor of $\RC$, it suffices to show $\rcrat(q) \sim_\epsilon \rclim(\lam{\blank} \rcrat(q))$ for all $\epsilon:\Qp$.
  And by the second constructor of $\sim$, for this it suffices to find $\delta,\theta:\Qp$ such that $\rcrat(q)\sim_{\epsilon-\delta-\theta} \rcrat(q)$.
  But by the first constructor of $\sim$, we may choose any $\delta$ and $\theta$ such that $\delta+\theta <\epsilon$.
\end{proof}

% 

\begin{lem} \label{RC-lim-factor}
  If $A$ is a set and $f : \CAP \to A$ respects coincidence of Cauchy approximations, in the sense that
  %
  \begin{equation*}
    \fall{x, y : \CAP} \rclim(x) = \rclim(y) \Rightarrow f(x) = f(y),
  \end{equation*}
  %
  then $f$ factors uniquely through $\rclim : \CAP \to \RC$.
\end{lem}
\begin{proof}
  Since $\rclim$ is surjective, by \autoref{lem:images_are_coequalizers}, $\RC$ is the quotient of $\CAP$ by the kernel of $\rclim$.
  But this is exactly the statement of the lemma.
\end{proof}

For the second special case of the induction principle, suppose instead that we are given only $C:\RC\to\RC\to\Qp\to\prop$, and define $A(\blank)\defeq\unit$ and $B(u,v,\blank,\blank,\epsilon,\blank)\defeq C(u,v,\epsilon)$.
Then the required data reduces to:
\begin{itemize}
\item For $q,r:\Q$ and $\epsilon:\Qp$, if $-\epsilon < q - r < \epsilon$, then $C(\rcrat(q),\rcrat(r),\epsilon)$.
\item For $q:\Q$ and $\delta,\epsilon,\theta:\Qp$ and $y$ a Cauchy approximation, if $\rcrat(q) \sim_{\epsilon - \delta - \theta} y_\delta$ and
  $C(\rcrat(q),y_\delta,\epsilon-\delta-\theta)$,
  then $C(\rcrat(q),\rclim(y),\epsilon)$.
\item Similarly, for $r:\Q$ and $\delta,\epsilon,\theta:\Qp$ and $x$ a Cauchy approximation, if $x_\delta \sim_{\epsilon - \delta - \theta} \rcrat(r)$ and
  $C(x_\delta,\rcrat(r),\epsilon-\delta-\theta)$,
  then $C(\rclim(y),\rcrat(q),\epsilon)$.
\item For $\epsilon,\delta,\eta,\theta:\Qp$ and $x,y$ Cauchy approximations, if $x_\delta \sim_{\epsilon - \delta - \eta - \theta} y_\eta$ and
  $C(x_\delta,y_\eta,{\epsilon - \delta - \eta - \theta})$,
  then $C(\rclim(x),\rclim(y),\epsilon)$.
\end{itemize}
The resulting conclusion is $\fall{u,v:\RC}{\epsilon:\Qp} (u\sim_\epsilon v) \to C(u,v,\epsilon)$.
We call this principle \emph{$\sim$-induction}; it says essentially that if we take $\RC$ as given, then $\sim_\epsilon$ is inductively generated (as a family of types) by \emph{its} constructors.
For example, we can use this to show that $\sim$ is symmetric.

\begin{lem}\label{thm:RCsim-symmetric}
  For any $u,v:\RC$ and $\epsilon:\Qp$, we have $(u\sim_\epsilon v) = (v\sim_\epsilon u)$.
\end{lem}
\begin{proof}
  Since both are mere propositions, by symmetry it suffices to show one implication.
  Thus, let $C(u,v,\epsilon) \defeq (v\sim_\epsilon u)$.
  By $\sim$-induction, we may reduce to the case that $u\sim_\epsilon v$ is derived from one of the four interesting constructors of $\sim$.
  In the first case when $u$ and $v$ are both rational, the result is trivial (we can apply the first constructor again).
  In the other three cases, the inductive hypothesis (together with commutativity of addition in $\Q$) yields exactly the input to another of the constructors of $\sim$ (the second and third constructors switch, while the fourth stays put).
\end{proof}

The general induction principle, which we may call \emph{$(\RC,\sim)$-induction}, is therefore a sort of joint $\RC$-induction and $\sim$-induction.
Consider, for instance, its non-dependent version, which we call \emph{$(\RC,\sim)$-recursion}.
Ordinary $\RC$-recursion tells us that to define a function $f : \RC \to A$ it suffices to:
\begin{enumerate}
\item for every $q : \Q$ construct $f(\rcrat(q)) : A$,
\item for every Cauchy approximation $x : \Qp \to \RC$, construct $f(x) : A$,
  assuming that $f(x_\epsilon)$ has already been defined for all $\epsilon : \Qp$,
\item prove $f(u) = f(v)$ for all $u, v : \RC$ satisfying~\eqref{eq:RC-path}.\label{item:rcrec3}
\end{enumerate}
However, it is generally quite difficult to show~\ref{item:rcrec3} without knowing something about how $f$ acts on $\epsilon$-close Cauchy reals.
The enhanced principle of $(\RC,\sim)$-recursion remedies this deficiency, allowing us to specify an \emph{arbitrary} ``way in which $f$ acts on $\epsilon$-close Cauchy reals'' (the predicate $B:A\to A\to \Qp\to\prop$), which we can then prove to be the case by a simultaneous induction with the definition of $f$.

\begin{eg}
As a simple example, let us define the absolute value function $|-| : \RC \to \RC$.
We may try to apply $\RC$-recursion with $A\defeq \RC$.
Of course, we want to define $|\rcrat(q)| \defeq \rcrat(|q|)$, and let $|\rclim(x)|$ be the limit of the Cauchy approximation $\delta\mapsto |x_\delta|$ (it is easy to show that this is still a Cauchy approximation).
Now, however, we need to prove that if $\fall{\epsilon:\Qp} u\sim_\epsilon v$, then $|u|=|v|$, and it is not obvious how to do this.

The most natural way to conclude $|u|=|v|$ is by the path-constructor of $\RC$, for which we would need to know that $\fall{\epsilon:\Qp} |u|\sim_\epsilon |v|$.
Thus, if we knew that $(u\sim_\epsilon v) \to (|u|\sim_\epsilon|v|)$, we would be in business.
And if we use $(\RC,\sim)$-recursion rather than $\RC$-recursion, we can obtain exactly this, by choosing $B$ to be the relation $\mathord\sim :\RC\to\RC\to\Qp\to\prop$ itself.
The hypothesis $\fall{\epsilon:\Qp} B(u,v,a,b,\epsilon,h(\epsilon))$ in the third datum required for $(\RC,\sim)$-induction specializes in this case exactly to $\fall{\epsilon:\Qp} |u|\sim_\epsilon |v|$.

Of course, now we've accumulated four more proof obligations: we need to do the simultaneous $\sim$-induction.
However, in all of these cases the inductive hypothesis is exactly what we need.
For instance, the second case amounts to proving that if $|\rcrat(q)| \sim_{\epsilon-\delta-\theta} |y_\delta|$, then $|\rcrat(q)| \sim_\epsilon |\rclim(y)|$, which follows directly from the second constructor of $\sim$ and the definition of absolute value on rationals and limits.
\end{eg}

Soon we will prove more general theorems on extending functions from $\Q$ to $\RC$, but first we must address a crucial question.
We have specified, in the constructors of $\sim$, the conditions under which we want Cauchy reals of the two different forms to be $\epsilon$-close.
However, how do we know that in the resulting inductive-inductive type family, these are the \emph{only} witnesses to this fact?
We have seen that inductive type families (such as identity types, see \autoref{sec:identity-systems}) and higher inductive types have a tendency to contain ``more than was put into them'', so this is not an idle question.

In order to characterize $\sim$ more precisely, we will define a family of relations $\approx_\epsilon$ on $\RC$ \emph{recursively}, so that they will compute on constructors, and prove that this family is equivalent to $\sim_\epsilon$.
More specifically, we will define $\mathord\approx:\RC\to\RC\to\Qp\to\prop$, together with some of its basic properties, by double $(\RC,\sim)$-recursion.
Roughly, the $\RC$-part of the definition will be the family of relations $\approx_\epsilon$, together with the fact that they are \emph{rounded}.
The $\sim$-part of the definition will be that these relations satisfy the ``triangle inequality'' with respect to $\sim_\epsilon$.
These two facts will be what enable us to show that $\approx_\epsilon$ respects the path constructor of $\RC$, allowing the recursion to go through.

To make this precise, we first apply $(\RC,\sim)$-recursion with
\begin{align*}
  A \defeq\;& \sm{a:\RC\to\Qp\to\prop} \\
  &\Big(\fall{u:\RC}{\epsilon:\Qp}
  \big(a(u,\epsilon) \leftrightarrow \exis{\theta:\Qp} a(u,\epsilon-\theta)\big)\Big)  \\
  &\land \Big(\fall{u,v:\RC}{\eta,\epsilon:\Qp} (u\sim_\epsilon v) \to\\
  &\hspace{2cm}\big(a(u,\eta) \to a(v,\eta+\epsilon) \big) \land \big(a(v,\eta) \to a(u,\eta+\epsilon) \big)\Big)\\
  B(a,b,\epsilon) \defeq\;& \fall{u:\RC}{\eta:\Qp} (a(u,\eta) \to b(u,\epsilon+\eta)) \land (b(u,\eta) \to a(u,\epsilon+\eta)).
\end{align*}
In this definition of $B$, and elsewhere, we use the same notation for an inhabitant of $A$ and its first component (the other components being mere properties).
For this $A$ and $B$, the first two data the recursion principle requires are
\begin{itemize}
\item For any $q:\Q$, an element of $A$, which we will denote by $(\rcrat(q)\approx_{(-)} -)$.
\item For any Cauchy approximation $x$ and any $a:\Qp \to A$, which we will denote by $\epsilon \mapsto (x_\epsilon \approx_{(-)} -)$, such that
  % \[ \fall{u,v:\RC}{\delta,\epsilon,\eta:\Qp} (x_\delta \approx_\eta u) \to (u\sim_{\delta+\epsilon} v) \to (x_\epsilon \approx_{\eta+\delta+\epsilon} v) \]
  \begin{equation}
    \fall{u:\RC}{\delta,\epsilon,\eta:\Qp} (x_\delta \approx_\eta u) \to (x_\epsilon \approx_{\eta+\delta+\epsilon} u),\label{eq:appxrec2}
  \end{equation}
  an element of $A$, which we will denote $(\rclim(x)\approx_{(-)} -)$.
\end{itemize}
In both cases, we give the required definition by using a nested $(\RC,\sim)$-recursion, now with
\begin{align*}
  A' &\defeq \sm{a':\Qp\to\prop} \fall{\epsilon:\Qp}
  \big(a'(\epsilon) \leftrightarrow \exis{\theta:\Qp} a'(\epsilon-\theta)\big)\\
  B'(a',b',\epsilon) &\defeq \fall{\eta:\Qp} (a'(\eta) \to b'(\epsilon+\eta)) \land (b'(\eta) \to a'(\epsilon+\eta)).
\end{align*}
Note that in both cases, the result of the sub-recursion consists of functions $f:\RC\to A'$ and $g:\prd{u,v:\RC}{\epsilon:\Qp} (u\sim_\epsilon v) \to B'(f(u),f(v),\epsilon)$.
Of these, $f$ yields the first two components of an element of $A$, while $g$ yields the third.
Thus, this will indeed satisfy the first two data required by the outer recursion.

Considering now the first two data required by the sub-recursion in both cases, we can actually give the definitions.
Of course, we merely mimic the constructors of $\sim$.
\begin{itemize}
\item For any $q,r:\Q$, we need a predicate denoted $\rcrat(q)\approx_{(-)} \rcrat(r)$.
  We define
  \begin{equation}
  \rcrat(q) \approx_\epsilon \rcrat(r)  \defeq
  -\epsilon < q - r < \epsilon\label{eq:appxratrat}
  \end{equation}
  It is obvious that these predicates are rounded.
\item For any $q:\Q$ and Cauchy approximation $y$ with relations $\rcrat(q) \approx_{(-)} y_\epsilon$ such that
  some conditions hold,
  % \[ \fall{\delta,\epsilon,\eta:\Qp} (\rcrat(q) \approx_\eta y_\delta) \to (\rcrat(q) \approx_{\eta+\delta+\epsilon} y_\epsilon), \]
  we need a predicate $\rcrat(q)\approx_{(-)} \rclim(y)$.
  We define
  \begin{equation}
  \rcrat(q) \approx_\epsilon \rclim(y) \defeq
  \exis{\delta, \theta : \Qp} \rcrat(q) \approx_{\epsilon - \delta - \theta} y_\delta\label{eq:appxratlim}
  \end{equation}
  These are rounded, using the inductive hypothesis that $\rcrat(q) \approx_{(-)} y_\epsilon$ is rounded.
\item For any Cauchy approximation $x$ and $r:\Q$ with relations $x_\epsilon \approx_{(-)} \rcrat(r)$ such that
  some condition holds,
  % \[ \fall{\delta,\epsilon,\eta:\Qp} (x_\delta \approx_\eta \rcrat(r)) \to (x_\epsilon  \approx_{\eta+\delta+\epsilon} \rcrat(r)), \]
  we need a predicate $\rclim(x)\approx_{(-)} \rcrat(r)$.
  We define
  \begin{equation}
    \rclim(x) \approx_\epsilon \rcrat(r) \defeq
    \exis{\delta, \theta : \Qp} x_\delta \approx_{\epsilon - \delta - \theta} \rcrat(r)\label{eq:appxlimrat}
  \end{equation}
\item For Cauchy approximations $x$ and $y$ with relations $(x_\epsilon \approx_{(-)} -)$ satisfying~\eqref{eq:appxrec2} and relations $(\rclim(x) \approx_{(-)} y_\epsilon)$ such that
  some condition holds,
  % \[ \fall{\delta,\epsilon,\eta:\Qp} (\rclim(x) \approx_\eta y_\delta) \to (\rclim(x) \approx_{\eta+\delta+\epsilon} y_\epsilon), \]
  we need a predicate $\rclim(x) \approx_{(-)} \rclim(y)$.
  We define
  \begin{equation}\label{eq:appxlimlim}
    \rclim(x) \approx_\epsilon \rclim(y) \defeq
    \exis{\delta, \eta, \theta : \Qp} x_\delta \approx_{\epsilon - \delta - \eta - \theta} y_\eta.
  \end{equation}  
\end{itemize}
In both cases, the third datum required by the sub-recursion becomes (using the fact that our predicates are mere propositions, along with function extensionality):
\begin{itemize}
\item If $\fall{\epsilon:\Qp} u\sim_\epsilon v$, and $a',b':A'$ with $\fall{\epsilon:\Qp} B'(a',b',\epsilon)$, then we need $\fall{\epsilon:\Qp} a'(\epsilon) \leftrightarrow b'(\epsilon)$.
\end{itemize}
Here the assumption of $B'$ means
\[\fall{\epsilon,\eta:\Qp} (a'(\eta) \to b'(\eta+\epsilon)) \land (b'(\eta) \to a'(\eta+\epsilon)).\]
But by roundedness, this easily implies the desired conclusion.

The remaining data of the sub-recursion, in the two cases, consists of showing that \cref{eq:appxratrat,eq:appxratlim,eq:appxlimrat,eq:appxlimlim} satisfy the triangle inequality on the right with respect to the constructors of $\sim$.
In the triply rational case this is obvious, while in the other cases it follows from the inductive hypotheses.
The relevant inductive hypotheses are that (1) in the Cauchy-approximation cases of the recursor, we assume $B'$ holds for the relevant approximating points, and (2) the relations $(x_\epsilon \approx_{(-)} -)$ are hypothesized to lie in $A$, which includes as part of the definition that they satisfy the triangle inequality on the right with respect to $\sim$.

This completes the two sub-recursions, and thereby the first two data required for the outer recursion: relations $(\rcrat(q)\approx_{(-)}-)$ and $(\rclim(x)\approx_{(-)}-)$ which are rounded, satisfy the triangle inequality on the right with respect to $\sim$, and satisfy~\eqref{eq:appxrec2}.
The third datum now becomes
\begin{itemize}
\item If $u,v:\RC$ satisfy $\fall{\epsilon:\Qp} u\sim_\epsilon v$, and $(u\approx_{(-)}-)$ and $(v\approx_{(-)}-)$ are arbitrary relations that are rounded and satisfy the right triangle inequality, and moreover
  \[ \fall{w:\RC}{\epsilon,\eta:\Qp} ((u\approx_\eta w) \to (v\approx_{\eta+\epsilon} w)) \land
  ((v\approx_\eta w) \to (u\approx_{\eta+\epsilon} w))
  \]
  then for all $w:\RC$ and $\epsilon:\Qp$ we have $(u\approx_{\epsilon} w) \leftrightarrow (v\approx_{\epsilon} w)$.
\end{itemize}
However, as before this follows easily from roundedness.

The remaining data of the outer recursion require that the relations $(\rcrat(q)\approx_{(-)}-)$ and $(\rclim(x)\approx_{(-)}-)$ we have just defined satisfy the triangle inequality on the \emph{left} with respect to the constructors of $\sim$.
Since this is a mere predicate, by $\RC$-induction, it suffices to prove it when the right-hand element is either rational or a limit, with an inductive hypothesis in the second case --- and in both cases, the definitions of these relations evaluate, since they are defined recursively.
Now the result is obvious in the triply rational case, while in the other cases it follows from the aforementioned inductive hypothesis, together with the inductive hypotheses of $B$ in the Cauchy-approximation cases.

This completes the definition of $\mathord\approx$.
We can now prove:

\begin{thm}\label{thm:RC-sim-characterization}
  For any $u,v:\RC$ and $\epsilon:\Qp$ we have $(u\sim_\epsilon v) = (u\approx_\epsilon v)$.
\end{thm}
\begin{proof}
  Since both are mere propositions, it suffices to prove bidirectional implication.
  For the left-to-right direction, we use $\sim$-induction with $C(u,v,\epsilon)\defeq (u\approx_\epsilon v)$.
  Thus, it suffices to consider the four constructors of $\sim$.
  In each case, $u$ and $v$ are specialized to either rational points or limits, so that the definition of $\approx$ evaluates, and the inductive hypothesis always applies.

  For the right-to-left direction, we use $\RC$-induction to assume that $u$ and $v$ are either rational points or limits, again allowing $\approx$ to evaluate.
  But now the definitions of $\approx$, and the inductive hypotheses, supply exactly the data required for the relevant constructors of $\sim$.
\end{proof}

Stretching a point, one might call $\approx$ a fibration of ``codes'' for $\sim$, with the two directions of the above proof being \encode and \decode respectively.
By the definition of $\approx$, from \autoref{thm:RC-sim-characterization} we get equivalences
\begin{align*}
  (\rcrat(q) \sim_\epsilon \rcrat(r))  &=
  (-\epsilon < q - r < \epsilon)\\
  (\rcrat(q) \sim_\epsilon \rclim(y)) &=
  \exis{\delta, \theta : \Qp} \rcrat(q) \sim_{\epsilon - \delta - \theta} y_\delta\\
  (\rclim(x) \sim_\epsilon \rcrat(r)) &=
  \exis{\delta, \theta : \Qp} x_\delta \sim_{\epsilon - \delta - \theta} \rcrat(r)\\
  (\rclim(x) \sim_\epsilon \rclim(y)) &=
  \exis{\delta, \eta, \theta : \Qp} x_\delta \sim_{\epsilon - \delta - \eta - \theta} y_\eta.
\end{align*}
Our proof also provides the following additional information.

\begin{cor}\ 
  \begin{enumerate}
  \item \label{RC-sim-rounded}
    $\sim$ is \emph{rounded}:
    for all $u, v : \RC$ and $\epsilon : \Qp$
    %
    \begin{equation*}
      \eqvspaced{
        (u \sim_\epsilon v)
      }{
        \exis{\theta : \Qp} u \sim_{\epsilon - \theta} v
      },
    \end{equation*}
  \item \label{item:RC-sim-triangle}
    $\sim$ satisfies the triangle inequality: for all $u,v,w:\RC$ and $\epsilon,\delta:\Qp$
    \begin{equation*}
      (u\sim_\epsilon v) \to (v\sim_\delta w) \to (u\sim_{\epsilon+\delta} w).
    \end{equation*}
  \end{enumerate}
\end{cor}
\begin{proof}
  The construction of $\approx$ showed simultaneously that it is rounded, and satisfies ``triangle inequalities'' such as
  \[ (u\approx_\epsilon v) \to (v\sim_\delta w) \to (u\approx_{\epsilon+\delta} w). \]
  Thus, both properties follow from \autoref{thm:RC-sim-characterization}.
\end{proof}

Note that reading \autoref{RC-sim-rounded} from right to left gives \emph{monotonicity} of $\sim$,
%
\begin{equation*}
  (\delta < \epsilon) \land (u \sim_\delta v) \Rightarrow u \sim_\epsilon v
\end{equation*}
%
and reading it left to right to \emph{openness} of $\sim$,
%
\begin{equation*}
  u \sim_\epsilon v \Rightarrow \exis{\epsilon : \Qp} (\delta < \epsilon) \land u \sim_\delta v.
\end{equation*}

With the triangle inequality, we can show that ``limits'' of Cauchy approximations actually behave like limits.

\begin{lem}\label{thm:RC-sim-lim}
  For any $u:\RC$, any Cauchy approximation $y$, and any $\epsilon,\delta,\theta:\Qp$, if $u\sim_\epsilon y_\delta$ then $u\sim_{\epsilon+\delta+\theta} \rclim(y)$.
\end{lem}
\begin{proof}
  We use $\RC$-induction on $u$.
  If $u$ is $\rcrat(q)$, then this is exactly the second constructor of $\sim$.
  Now suppose $u$ is $\rclim(x)$, and that each $x_\eta$ has the property that for any $y,\epsilon,\delta,\theta$, if $x_\eta\sim_\epsilon y_\delta$ then $x_\eta \sim_{\epsilon+\delta+\theta} \rclim(y)$.
  In particular, taking $y\defeq x$ and $\delta\defeq\eta$ in this assumption, we conclude that $x_\eta \sim_{\eta+\theta} \rclim(x)$ for any $\eta,\theta:\Qp$, and in particular $x_\eta \sim_{2\eta} \rclim(x)$.

  Now let $y,\epsilon,\delta,\theta$ be arbitrary and assume $\rclim(x) \sim_\epsilon y_\delta$.
  Then by the triangle inequality, for any $\eta$ we have $x_\eta \sim_{\epsilon+2\eta} y_\delta$.
  Hence the fourth constructor of $\sim$ yields $\rclim(x) \sim_{\epsilon+4\eta+\delta} \rclim(y)$.
  Thus it suffices to take $\eta \defeq \theta/4$.
\end{proof}

\begin{lem}\label{thm:RC-sim-lim-term}
  For any Cauchy approximation $y$ and any $\delta,\eta:\Qp$ we have $y_\delta \sim_{\delta+\eta} \rclim(y)$.
\end{lem}
\begin{proof}
  Take $u\defeq y_\delta$ and $\epsilon\defeq\theta\defeq \eta/2$ in the previous lemma.
\end{proof}

Finally, we prove that Lipschitz functions extend uniquely from $\Q$ to $\RC$.
We present here univariate versions, even though we shall require multivariate ones as well.

\begin{lem} \label{RC-Lipschitz-eq}
  Suppose $f,g : \RC \to \RC$ are Lipschitz maps, in the sense that there is $L : \Qp$
  such that $u \sim_\epsilon v$ implies $f(u) \sim_{L \epsilon} f(v)$ and $g(u) \sim_{L
    \epsilon} g(v)$, for all $u, v : \RC$ and $\epsilon : \Qp$. If $f(\rcrat(q)) =
  g(\rcrat(q))$ for all $q : \Qp$ then $f = g$.
\end{lem}

\begin{proof}
  We show that $f(u) = g(u)$ for all $u : \RC$ by $\RC$-induction on $u$. When $u$ is
  $\rcrat(q)$ this holds by assumption. When $u$ is $\rclim(x)$ we prove $f(\rclim(x)) =
  g(\rclim(x))$ using~\eqref{eq:RC-path}. For any $\epsilon : \Qp$, using \autoref{thm:RC-sim-lim-term} we have
  %
  \begin{equation*}
    \rclim(x) \sim_{\epsilon/(2 L)}
    x_{\epsilon/(4 L)} =
    x_{\epsilon/(4 L)} \sim_{\epsilon/(2 L)}
    \rclim(x).
  \end{equation*}
  %
  Now, by the Lipschitz condition and the induction hypothesis
  %
  \begin{equation*}
    f(\rclim(x)) \sim_{\epsilon/2}
    f(x_{\epsilon/(4L)}) =
    g(x_{\epsilon/(4L)}) \sim_{\epsilon/2}
    g(\rclim(x)),
  \end{equation*}
  %
  therefore $f(\rclim(x)) \sim_\epsilon g(\rclim(x))$ by the triangle inequality, as required.
\end{proof}

\begin{lem}\label{RC-extend-Q-Lipschitz}
  Suppose $f : \Q \to \Q$ is a Lipschitz map with a Lipschitz constant $L : \Qp$, so that
  $|f(q) - f(r)| \leq L \cdot |q - r|$ for all $q, r : \Q$. There is a unique $\bar{f} :
  \RC \to \RC$ for which $\bar{f} \circ \rcrat = \rcrat \circ f$ and the Lipschitz
  condition holds: for all $u, v : \RC$ and $\epsilon : \Qp$,
  %
  \begin{equation*}
    (u \sim_\epsilon v) \Rightarrow (\bar{f}(u) \sim_{L \epsilon} \bar{f}(v)).
  \end{equation*}
\end{lem}

\begin{proof}
  Uniqueness follows directly from \autoref{RC-Lipschitz-eq}.
  For existence, we define $\bar{f}$ and its Lipschitz property by joint $(\RC,\sim)$-recursion.
  That is, we apply $(\RC,\sim)$-recursion with
  \begin{align*}
    A &\defeq \RC\\
    B(a,b,\epsilon) &\defeq (a \sim_{L\epsilon} b).
  \end{align*}
  For $q : \Q$, we define
  %
  \begin{equation*}
    \bar{f}(\rcrat(q)) \defeq \rcrat(f(q))
  \end{equation*}
  %
  and for a Cauchy approximation $x : \Qp \to \RC$, we define
  % 
  \begin{equation*}
    \bar{f}(\rclim(x)) \defeq \rclim(\lamu{\epsilon : \Qp} \bar{f}(x_{\epsilon/L})).
  \end{equation*}
  %
  Here $y \defeq \lamu{\epsilon : \Qp} \bar{f}(x_{\epsilon/L})$ is a Cauchy approximation because, for all $\delta, \epsilon : \Qp$, from the Cauchy condition
  $x_{\delta/L} \sim_{(\delta + \epsilon)/L} x_{\epsilon/L}$ for $x$, the induction hypothesis~\eqref{eq:depCauchyappx} yields
  \[y_\delta \jdeq f(x_{\delta/L}) \sim_{\delta + \epsilon} f(x_{\epsilon/L})   \jdeq y_\epsilon. \]
  This covers the first two data required for the induction.

  The third is to show that these definitions respect equality, i.e.\ if $\fall{\epsilon : \Qp} u \sim_\epsilon v$, then $\bar{f}(u) = \bar{f}(v)$.
  However, in this case the inductive hypothesis applied to $u\sim_{\epsilon/L} v$ yields $\bar{f}(u) \sim_{\epsilon} \bar{f}(v)$, so we can apply the path constructor of $\RC$.

  It remains to prove the Lipschitz condition for all four constructors of $\sim$.
  \begin{enumerate}

  \item When $u$ is $\rcrat(q)$ and $v$ is $\rcrat(r)$ with $-\epsilon < |q-r| <\epsilon$, the Lipschitz condition is just the assumption that $f$ is Lipschitz.

  \item When $u$ is $\rclim(x)$ and $v$ is $\rcrat(q)$ with $x_\eta \sim_{\epsilon - \eta - \theta} \rcrat(q)$, then the
      induction hypothesis yields $\bar{f}(x_\eta) \sim_{L \epsilon - L \eta - L \theta} \rcrat(f(q))$, which proves $\bar{f}(\rclim(x)) \sim_{L \epsilon}
      \bar{f}(\rcrat(q))$.

  \item The symmetric case when $u$ is rational and $v$ is a limit is essentially identical.

  \item When $u$ is $\rclim(x)$ and $v$ is $\rclim(y)$, with $\delta, \eta,
      \theta : \Qp$ such that $x_\delta \sim_{\epsilon - \delta - \eta - \theta} y_\eta$,
      the induction hypothesis yields $\bar{f}(x_\delta) \sim_{L \epsilon - L \delta - L
        \eta - L \theta} \bar{f}(y_\eta)$, which proves $\bar{f}(\rclim(x)) \sim_{L
        \epsilon} \bar{f}(\rclim(y))$.\qedhere
  \end{enumerate}
\end{proof}

\subsection{Additive structure}
\label{sec:additive-structure-order}

It is tedious to define a function on $\RC$ with bare hands, but we can use (the
multivariate variant of) \autoref{RC-Lipschitz-eq,RC-extend-Q-Lipschitz} to define the
additive and the lattice structure of the reals.

Addition and subtraction are Lipschitz functions on rationals, so they extend to reals and
the extensions satisfy the same equations. This shows that $(\RC, {+}, {-}, 0)$ is a
commutative group.

\begin{thm} \label{RC-commutative-group}
  The Cauchy reals form a commutative group.
\end{thm}

\subsection{Order}
\label{sec:order}

Next, $\min$ and $\max$ are Lipschitz as well, so they can be extended to give $\RC$ the
structure of a lattice, which interacts as expected with the commutative group structure.
The mere binary relation $\leq$, defined for $u, v : \RC$ by
%
\begin{equation*}
  (u \leq v) \defeq \max(u,v) = v
\end{equation*}
%
is a partial order on $\RC$, for which $\min$ and $\max$ are the infimum and supremum. The
strict order $<$ is defined constructively as
%
\begin{equation*}
  (u < v) \defeq
  \exis{q, r : \Q} (q < r) \land (x \leq \rcrat(q)) \land (\rcrat(r) \leq y).
\end{equation*}
%
That is, a witness for $u < v$ is a pair or rational numbers $q < r$ such that $x \leq
\rcrat(q)$ and $\rcrat(r) \leq v$. The strict order is irreflexive and transitive, but we
have to be careful about linearity. We shall address this in \autoref{sec:RC-order}, for
now we focus on expressing $u \sim_\epsilon v$ with standard concepts. Note that the
absolute value $|{-}|$ is a Lipschitz function on $\Q$, which therefore extends to $\RC$
and has the expected properties.

We are now able to show that the auxiliary relation $\sim$ is what we think it is.

\begin{thm} \label{RC-sim-eqv-le}
  $\eqv{(u \sim_\epsilon v)}{(|u - v| < \rcrat(\epsilon))}$
  for all $u, v : \RC$ and $\epsilon : \Qp$.
\end{thm}

\begin{proof}
  Since both are mere propositions, it suffices to show that each implies the other.
  From left to right, we use $\sim$-induction.
  The doubly rational case is easy, since absolute value, subtraction, and $<$ restrict to the original notions on $\Q$.
  TODO: Need $|x_\delta - \rclim(x)|<\rcrat(\delta)$.

  From right to left, we use $\RC$-induction on $u$ and $v$.
  Again, the doubly rational case is immediate.
\end{proof}

TODO: Prove or state relevant properties of $<$.

\subsection{The ring structure}
\label{sec:ring-structure}

TODO: Get multiplication working.

\subsection{The field structure}
\label{sec:field-structure}

TODO: Introduce apartness and inverses.

\subsection{Completeness}
\label{sec:completeness-RC}

TODO: State traditional Cauchy completion


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Comparison of Cauchy and Dedekind Reals}
\label{sec:comp-cacuhy-dedek}

Cauchy embeds in Dedekind, we do not expect them to be the same (sheaf model over the
reals) Note, we do not use univalence, hence we have models in sSh(X).

They are the same if we have CAC for Sigma-predicates
Also, $Sigma = 2^N/\sim$.


\subsection{Intuitionstic vs.\ Classical Analysis}
\label{sec:intuitionistic-vs-classical-analysis}

TODO: Example theorems: mean-value theorem.


\section*{Notes}
\label{sec:reals-notes}

\section*{Exercises}
\label{sec:reals-exercises}

\begin{ex}
  Show that $\leq$ is the negation of $<$ on $\RD$. Is $<$ the negation of $\leq$?
\end{ex}

\begin{ex} \label{ex:reals-non-constant-into-Z}
  \mbox{}
  %
  \begin{enumerate}
  \item Assuming excluded middle, construct a non-constant map $\RD \to \Z$.
  \item Suppose $f : \RD \to \Z$ is a map such that $f(0) = 0$ and $f(x) \neq 0$ for all
    $x > 0$. Derive from this the following limited form of excluded middle, known as the
    \emph{Limited Principle of Omniscience (LPO)}: for every $\alpha : \N \to \bool$,
    %
    \begin{equation*}
      (\sm{n : \N} \alpha(n) = \btrue) + (\prd{n : \N} \alpha(n) = \bfalse).
    \end{equation*}
    %
  \end{enumerate}
\end{ex}

\begin{ex} \label{ex:reals-apart-neq-MP}
  \emph{Markov principle} says that for all $f : \nat \to \bool$,
  %
  \begin{equation*}
    (\lnot \lnot \exis{n : \nat} f(n) = \btrue)
    \Rightarrow
    \exis{n : \nat} f(n) = \btrue.
  \end{equation*}
  %
  This is a particular instance of the law of double negation~\eqref{eq:ldn}. Show that
  $\fall{x, y: \RD} x \neq y \Rightarrow x \apart y$ implies Markov principle. Does the
  converse holds as well?
\end{ex}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "main"
%%% End: 
